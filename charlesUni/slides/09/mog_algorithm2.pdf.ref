Algorithm 9.2.2 of Pattern Recognition and Machine Learning.
